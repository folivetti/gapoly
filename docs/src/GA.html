<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : GA
Description : Genetic Algorithm for Poly Regression
Copyright   : (c) Fabricio Olivetti de Franca, 2021
License     : GPL-3
Maintainer  : fabricio.olivetti@gmail.com
Stability   : experimental
Portability : POSIX
|-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GA</span><span> </span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GA.html#select"><span class="hs-identifier">select</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GA.html#createRndSolution"><span class="hs-identifier">createRndSolution</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GA.html#crossover"><span class="hs-identifier">crossover</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GA.html#mutate"><span class="hs-identifier">mutate</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier">Solution</span></a></span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier">Sol</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GA.html#Population"><span class="hs-identifier">Population</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GA.html#Fitness"><span class="hs-identifier">Fitness</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.LinearAlgebra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | Data type representing a solution </span><span>
</span><span id="line-25"></span><span class="hs-keyword">data</span><span> </span><span id="Solution"><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-var">Solution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Sol"><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-var">Sol</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_vars"><span class="annot"><span class="annottext">Solution -&gt; [Bool]
</span><a href="GA.html#_vars"><span class="hs-identifier hs-var hs-var">_vars</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- ^ binary vector representing the presence of variables </span><span>
</span><span id="line-26"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="_exponents"><span class="annot"><span class="annottext">Solution -&gt; [Int]
</span><a href="GA.html#_exponents"><span class="hs-identifier hs-var hs-var">_exponents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ integer vector with exponents</span><span>
</span><span id="line-27"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="_coeffs"><span class="annot"><span class="annottext">Solution -&gt; Vector Double
</span><a href="GA.html#_coeffs"><span class="hs-identifier hs-var hs-var">_coeffs</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>  </span><span class="hs-comment">-- ^ coefficients of the regression</span><span>
</span><span id="line-28"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="_fitness"><span class="annot"><span class="annottext">Solution -&gt; Double
</span><a href="GA.html#_fitness"><span class="hs-identifier hs-var hs-var">_fitness</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>    </span><span class="hs-comment">-- ^ fitness of an individual </span><span>
</span><span id="line-29"></span><span>                    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679037160"><span id="local-6989586621679037162"><span id="local-6989586621679037164"><span class="annot"><span class="annottext">Int -&gt; Solution -&gt; ShowS
[Solution] -&gt; ShowS
Solution -&gt; String
(Int -&gt; Solution -&gt; ShowS)
-&gt; (Solution -&gt; String) -&gt; ([Solution] -&gt; ShowS) -&gt; Show Solution
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Solution] -&gt; ShowS
$cshowList :: [Solution] -&gt; ShowS
show :: Solution -&gt; String
$cshow :: Solution -&gt; String
showsPrec :: Int -&gt; Solution -&gt; ShowS
$cshowsPrec :: Int -&gt; Solution -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037156"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>  </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679037154"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037154"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679037153"><span class="annot"><span class="annottext">== :: Solution -&gt; Solution -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679037152"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037152"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037154"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037152"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679037138"><span id="local-6989586621679037140"><span id="local-6989586621679037142"><span id="local-6989586621679037144"><span id="local-6989586621679037147"><span id="local-6989586621679037149"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679037136"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037136"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679037135"><span class="annot"><span class="annottext">&lt;= :: Solution -&gt; Solution -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;=</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679037133"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037133"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037136"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037133"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="Population"><span class="annot"><a href="GA.html#Population"><span class="hs-identifier hs-var">Population</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span class="hs-keyword">type</span><span> </span><span id="Fitness"><span class="annot"><a href="GA.html#Fitness"><span class="hs-identifier hs-var">Fitness</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Creates a random solution </span><span>
</span><span id="line-42"></span><span class="annot"><a href="GA.html#createRndSolution"><span class="hs-identifier hs-type">createRndSolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Fitness"><span class="hs-identifier hs-type">Fitness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span id="createRndSolution"><span class="annot"><span class="annottext">createRndSolution :: Int -&gt; Fitness -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#createRndSolution"><span class="hs-identifier hs-var hs-var">createRndSolution</span></a></span></span><span> </span><span id="local-6989586621679037132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037132"><span class="hs-identifier hs-var">nLen</span></a></span></span><span> </span><span id="local-6989586621679037131"><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037131"><span class="hs-identifier hs-var">fit</span></a></span></span><span> </span><span id="local-6989586621679037130"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037130"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037129"><span class="hs-identifier hs-var">sol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037128"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679037127"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037127"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037128"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037128"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (StdGen, StdGen)
forall g. RandomGen g =&gt; g -&gt; (g, g)
</span><span class="hs-identifier hs-var">split</span></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037130"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679037125"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037125"><span class="hs-identifier hs-var">g1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037124"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037124"><span class="hs-identifier hs-var">g2'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (StdGen, StdGen)
forall g. RandomGen g =&gt; g -&gt; (g, g)
</span><span class="hs-identifier hs-var">split</span></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037127"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679037123"><span class="annot"><span class="annottext">vecBool :: [Bool]
</span><a href="#local-6989586621679037123"><span class="hs-identifier hs-var hs-var">vecBool</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Bool] -&gt; [Bool]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037132"><span class="hs-identifier hs-var">nLen</span></a></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; [Bool]) -&gt; [Bool] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool, Bool) -&gt; StdGen -&gt; [Bool]
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; [a]
</span><span class="hs-identifier hs-var">randomRs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037125"><span class="hs-identifier hs-var">g1'</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679037120"><span class="annot"><span class="annottext">vecInt :: [Int]
</span><a href="#local-6989586621679037120"><span class="hs-identifier hs-var hs-var">vecInt</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037132"><span class="hs-identifier hs-var">nLen</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; StdGen -&gt; [Int]
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; [a]
</span><span class="hs-identifier hs-var">randomRs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037124"><span class="hs-identifier hs-var">g2'</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679037129"><span class="annot"><span class="annottext">sol :: Solution
</span><a href="#local-6989586621679037129"><span class="hs-identifier hs-var hs-var">sol</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037131"><span class="hs-identifier hs-var">fit</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037123"><span class="hs-identifier hs-var">vecBool</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037120"><span class="hs-identifier hs-var">vecInt</span></a></span><span> </span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Tournament between two solutions</span><span>
</span><span id="line-52"></span><span class="annot"><a href="GA.html#tournament"><span class="hs-identifier hs-type">tournament</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GA.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span id="tournament"><span class="annot"><span class="annottext">tournament :: [Solution] -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#tournament"><span class="hs-identifier hs-var hs-var">tournament</span></a></span></span><span> </span><span id="local-6989586621679037118"><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037118"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679037117"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037117"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037116"><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037116"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037115"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037115"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (Solution, StdGen)
forall b. RandomGen b =&gt; b -&gt; (Solution, b)
</span><a href="#local-6989586621679037114"><span class="hs-identifier hs-var">chooseRnd</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037117"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span>
</span><span id="line-54"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621679037113"><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037113"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037112"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037112"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (Solution, StdGen)
forall b. RandomGen b =&gt; b -&gt; (Solution, b)
</span><a href="#local-6989586621679037114"><span class="hs-identifier hs-var">chooseRnd</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037115"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span>
</span><span id="line-55"></span><span>                   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Solution -&gt; Solution -&gt; Solution
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037116"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037113"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037112"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679037114"><span class="annot"><span class="annottext">chooseRnd :: b -&gt; (Solution, b)
</span><a href="#local-6989586621679037114"><span class="hs-identifier hs-var hs-var">chooseRnd</span></a></span></span><span> </span><span id="local-6989586621679037110"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679037110"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037109"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037109"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037108"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679037108"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; b -&gt; (Int, b)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Solution] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037118"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679037110"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-58"></span><span>                   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037118"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">[Solution] -&gt; Int -&gt; Solution
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037109"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679037108"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Creates a new solution from the combination of two solutions </span><span>
</span><span id="line-61"></span><span class="annot"><a href="GA.html#crossover"><span class="hs-identifier hs-type">crossover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GA.html#Fitness"><span class="hs-identifier hs-type">Fitness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span id="crossover"><span class="annot"><span class="annottext">crossover :: Fitness -&gt; [Solution] -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#crossover"><span class="hs-identifier hs-var hs-var">crossover</span></a></span></span><span> </span><span id="local-6989586621679037104"><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037104"><span class="hs-identifier hs-var">fit</span></a></span></span><span> </span><span id="local-6989586621679037103"><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037103"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679037102"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037102"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037101"><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037101"><span class="hs-identifier hs-var">sol1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037100"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037100"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Solution] -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#tournament"><span class="hs-identifier hs-var">tournament</span></a></span><span> </span><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037103"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037102"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-63"></span><span>                          </span><span class="hs-special">(</span><span id="local-6989586621679037099"><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037099"><span class="hs-identifier hs-var">sol2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037098"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037098"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Solution] -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#tournament"><span class="hs-identifier hs-var">tournament</span></a></span><span> </span><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037103"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037100"><span class="hs-identifier hs-var">g1</span></a></span><span>
</span><span id="line-64"></span><span>                      </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Fitness -&gt; Solution -&gt; Solution -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#cx"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037104"><span class="hs-identifier hs-var">fit</span></a></span><span> </span><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037101"><span class="hs-identifier hs-var">sol1</span></a></span><span> </span><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037099"><span class="hs-identifier hs-var">sol2</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037098"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Performs crossover </span><span>
</span><span id="line-66"></span><span class="annot"><a href="GA.html#cx"><span class="hs-identifier hs-type">cx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GA.html#Fitness"><span class="hs-identifier hs-type">Fitness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span id="cx"><span class="annot"><span class="annottext">cx :: Fitness -&gt; Solution -&gt; Solution -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#cx"><span class="hs-identifier hs-var hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679037096"><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037096"><span class="hs-identifier hs-var">fit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span id="local-6989586621679037095"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037095"><span class="hs-identifier hs-var">p1Bool</span></a></span></span><span> </span><span id="local-6989586621679037094"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037094"><span class="hs-identifier hs-var">p1Int</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span id="local-6989586621679037093"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037093"><span class="hs-identifier hs-var">p2Bool</span></a></span></span><span> </span><span id="local-6989586621679037092"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037092"><span class="hs-identifier hs-var">p2Int</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679037091"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037091"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Solution
</span><a href="#local-6989586621679037090"><span class="hs-identifier hs-var">child</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037089"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679037088"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037088"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037089"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037089"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; StdGen -&gt; (Int, StdGen)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037095"><span class="hs-identifier hs-var">p1Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037091"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679037087"><span class="annot"><span class="annottext">childBool :: [Bool]
</span><a href="#local-6989586621679037087"><span class="hs-identifier hs-var hs-var">childBool</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Bool] -&gt; [Bool] -&gt; [Bool]
forall a. Int -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679037086"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037088"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037095"><span class="hs-identifier hs-var">p1Bool</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037093"><span class="hs-identifier hs-var">p2Bool</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679037085"><span class="annot"><span class="annottext">childInt :: [Int]
</span><a href="#local-6989586621679037085"><span class="hs-identifier hs-var hs-var">childInt</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679037086"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037088"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037094"><span class="hs-identifier hs-var">p1Int</span></a></span><span>  </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037092"><span class="hs-identifier hs-var">p2Int</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679037086"><span class="annot"><span class="annottext">cx :: Int -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679037086"><span class="hs-identifier hs-var hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679037084"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037084"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679037083"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037083"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679037082"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037082"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037084"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037083"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037084"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037082"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679037090"><span class="annot"><span class="annottext">child :: Solution
</span><a href="#local-6989586621679037090"><span class="hs-identifier hs-var hs-var">child</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037096"><span class="hs-identifier hs-var">fit</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037087"><span class="hs-identifier hs-var">childBool</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037085"><span class="hs-identifier hs-var">childInt</span></a></span><span>  </span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Mutates a single solution</span><span>
</span><span id="line-77"></span><span class="annot"><a href="GA.html#mutate"><span class="hs-identifier hs-type">mutate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Fitness"><span class="hs-identifier hs-type">Fitness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span id="mutate"><span class="annot"><span class="annottext">mutate :: Double -&gt; Fitness -&gt; Solution -&gt; StdGen -&gt; (Solution, StdGen)
</span><a href="GA.html#mutate"><span class="hs-identifier hs-var hs-var">mutate</span></a></span></span><span> </span><span id="local-6989586621679037080"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037080"><span class="hs-identifier hs-var">prob</span></a></span></span><span> </span><span id="local-6989586621679037079"><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037079"><span class="hs-identifier hs-var">fit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Sol"><span class="hs-identifier hs-type">Sol</span></a></span><span> </span><span id="local-6989586621679037078"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037078"><span class="hs-identifier hs-var">vecBool</span></a></span></span><span> </span><span id="local-6989586621679037077"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037077"><span class="hs-identifier hs-var">vecInt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679037076"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037076"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037075"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037075"><span class="hs-identifier hs-var">vecBool'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037074"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037074"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; StdGen -&gt; ([Bool], StdGen)
forall t a. (Random a, RandomGen t) =&gt; [a] -&gt; [a] -&gt; t -&gt; ([a], t)
</span><a href="#local-6989586621679037073"><span class="hs-identifier hs-var">mutateBool</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037078"><span class="hs-identifier hs-var">vecBool</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037076"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679037072"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037072"><span class="hs-identifier hs-var">vecInt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037071"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037071"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; StdGen -&gt; ([Int], StdGen)
forall t a.
(Random a, RandomGen t, Num a) =&gt;
[a] -&gt; [a] -&gt; t -&gt; ([a], t)
</span><a href="#local-6989586621679037070"><span class="hs-identifier hs-var">mutateInt</span></a></span><span>  </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037077"><span class="hs-identifier hs-var">vecInt</span></a></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037074"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fitness
</span><a href="#local-6989586621679037079"><span class="hs-identifier hs-var">fit</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679037075"><span class="hs-identifier hs-var">vecBool'</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679037072"><span class="hs-identifier hs-var">vecInt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037071"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679037073"><span class="annot"><span class="annottext">mutateBool :: [a] -&gt; [a] -&gt; t -&gt; ([a], t)
</span><a href="#local-6989586621679037073"><span class="hs-identifier hs-var hs-var">mutateBool</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679037069"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037069"><span class="hs-identifier hs-var">bs'</span></a></span></span><span> </span><span id="local-6989586621679037068"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037068"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037069"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037068"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="#local-6989586621679037073"><span class="hs-identifier hs-var">mutateBool</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037066"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037066"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679037065"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037065"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679037064"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037064"><span class="hs-identifier hs-var">bs'</span></a></span></span><span> </span><span id="local-6989586621679037063"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037063"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037062"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037062"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037061"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037061"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; t -&gt; (Double, t)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037063"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-85"></span><span>                                   </span><span class="hs-special">(</span><span id="local-6989586621679037060"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037060"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037059"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037059"><span class="hs-identifier hs-var">g'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037062"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037080"><span class="hs-identifier hs-var">prob</span></a></span><span>
</span><span id="line-86"></span><span>                                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">t -&gt; (a, t)
forall a g. (Random a, RandomGen g) =&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">random</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037061"><span class="hs-identifier hs-var">g''</span></a></span><span>
</span><span id="line-87"></span><span>                                                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037066"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037061"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                               </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; t -&gt; ([a], t)
</span><a href="#local-6989586621679037073"><span class="hs-identifier hs-var">mutateBool</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037065"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037060"><span class="hs-identifier hs-var">b'</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037064"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037059"><span class="hs-identifier hs-var">g'''</span></a></span><span> </span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679037070"><span class="annot"><span class="annottext">mutateInt :: [a] -&gt; [a] -&gt; t -&gt; ([a], t)
</span><a href="#local-6989586621679037070"><span class="hs-identifier hs-var hs-var">mutateInt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span id="local-6989586621679037057"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037057"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span id="local-6989586621679037056"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037056"><span class="hs-identifier hs-var">g'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037057"><span class="hs-identifier hs-var">is'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037056"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="#local-6989586621679037070"><span class="hs-identifier hs-var">mutateInt</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037055"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037055"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679037054"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037054"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679037053"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037053"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span id="local-6989586621679037052"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037052"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679037051"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037051"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037050"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037050"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; t -&gt; (Double, t)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037052"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-91"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621679037049"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037049"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679037048"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037048"><span class="hs-identifier hs-var">g'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037051"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679037080"><span class="hs-identifier hs-var">prob</span></a></span><span>
</span><span id="line-92"></span><span>                                                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; t -&gt; (a, t)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">randomR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037050"><span class="hs-identifier hs-var">g''</span></a></span><span>
</span><span id="line-93"></span><span>                                                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037055"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037050"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                              </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; t -&gt; ([a], t)
</span><a href="#local-6989586621679037070"><span class="hs-identifier hs-var">mutateInt</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037054"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679037049"><span class="hs-identifier hs-var">i'</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679037053"><span class="hs-identifier hs-var">is'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679037048"><span class="hs-identifier hs-var">g'''</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Select the next generation</span><span>
</span><span id="line-97"></span><span class="annot"><a href="GA.html#select"><span class="hs-identifier hs-type">select</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GA.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GA.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span id="select"><span class="annot"><span class="annottext">select :: Int -&gt; [Solution] -&gt; StdGen -&gt; ([Solution], StdGen)
</span><a href="GA.html#select"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span id="local-6989586621679037047"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037047"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679037046"><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037046"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span id="local-6989586621679037045"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037045"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Solution] -&gt; [Solution]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679037047"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Solution]
</span><a href="#local-6989586621679037046"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679037045"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span></pre></body></html>